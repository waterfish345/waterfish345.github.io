import type { University, StarAdmission, ExamRequirement, RoundResult, ThresholdValue, DeptGroup } from '../types/university';

function req(subject: string, standard: string, level: number): ExamRequirement {
  return { subject, standard, level };
}

const shortToComparison: Record<string, string[]> = {
  '國英數A自': ['學測國英數A自'],
  '國英數B社': ['學測國英數B社'],
  '國英數A社': ['學測國英數A社'],
  '國英數A': ['學測國英數A'],
  '英數A社': ['學測英數A社'],
  '英數A自': ['學測英數A自'],
  '英數A社自': ['學測英數A社自'],
  '國英社': ['學測國英社'],
  '國英數B': ['學測國英數B'],
  '數A': ['學測數A'],
  '數B': ['學測數B'],
  '自': ['學測自然'],
  '社': ['學測社會'],
  '英': ['學測英文'],
  '英文': ['學測英文'],
  '國': ['學測國文'],
  '物理': ['物理學業'],
  '化學': ['化學學業'],
  '生物': ['生物學業'],
  '數學': ['數學學業'],
  '國語文': ['國語文學業'],
  '英語文': ['英語文學業'],
  '歷史': ['歷史學業'],
  '地理': ['地理學業'],
  '地科': ['地科學業'],
  '公社': ['公社學業'],
};

function findMatchingComparison(shortKey: string, comparisonOrder: string[]): string | null {
  if (comparisonOrder.includes(shortKey)) return shortKey;
  const candidates = shortToComparison[shortKey];
  if (candidates) {
    for (const c of candidates) {
      if (comparisonOrder.includes(c)) return c;
    }
  }
  for (const co of comparisonOrder) {
    if (co === '學測' + shortKey) return co;
    if (co === shortKey + '學業') return co;
  }
  return null;
}

function parseRound(raw: string, comparisonOrder: string[]): RoundResult | null {
  const trimmed = raw.trim();
  if (trimmed === '-' || trimmed === '') return null;
  const countMatch = trimmed.match(/^(\d+)人/);
  if (!countMatch) return null;
  const count = parseInt(countMatch[1], 10);
  const thresholds: ThresholdValue[] = [];
  const parenMatch = trimmed.match(/\((.+)\)/);
  if (parenMatch) {
    const inner = parenMatch[1];
    const parts = inner.split(',').map(s => s.trim());
    for (let i = 0; i < parts.length; i++) {
      const part = parts[i];
      if (i === 0) {
        thresholds.push({ item: comparisonOrder[0], value: part });
      } else {
        const match = part.match(/^([^\d%]+?)\s*(\d+%?)$/);
        if (match) {
          const shortKey = match[1].trim();
          const val = match[2];
          const compItem = findMatchingComparison(shortKey, comparisonOrder);
          if (compItem) {
            thresholds.push({ item: compItem, value: val });
          } else {
            thresholds.push({ item: shortKey, value: val });
          }
        }
      }
    }
  }
  return { count, thresholds };
}

function star(
  year: number, deptCode: string, quota: number, requirements: ExamRequirement[],
  comparisonOrder: string[], result: string
): StarAdmission {
  let round1: RoundResult | null = null;
  let round2: RoundResult | null = null;
  const r1Match = result.match(/R1:([^/]+)/);
  const r2Match = result.match(/R2:(.+)$/);
  if (r1Match) round1 = parseRound(r1Match[1], comparisonOrder);
  if (r2Match) round2 = parseRound(r2Match[1], comparisonOrder);
  return { channel: '繁星推薦', year, deptCode, quota, requirements, comparisonOrder, result, round1, round2 };
}

function dept(
  id: string, name: string, groupName: string,
  group: DeptGroup, admissions: StarAdmission[]
) {
  return { id, name, groupName, group, admissions };
}

export const universities: University[] = [
  {
    id: 'ntu',
    name: '國立臺灣大學',
    shortName: '台大',
    code: '001',
    type: '國立',
    category: '一般大學',
    location: { city: '台北市', district: '大安區' },
    departments: [
      // ==================== 第一類 ====================
      dept('00101', '中國文學系', '中國文學系', '一', [
        star(114, '00101', 6,
          [req('國','頂',13), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國文','學測英文','國語文學業','英語文學業','學測社會','歷史學業'],
          'R1:5人(7%) / R2:1人(2%)'),
        star(113, '00101', 6,
          [req('國','頂',13), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國文','學測英文','國語文學業','英語文學業','學測社會','歷史學業'],
          'R1:4人(4%) / R2:2人(3%)'),
      ]),
      dept('00102', '外國語文學系', '外國語文學系', '一', [
        star(114, '00102', 15,
          [req('國','前',12), req('英','頂',13), req('數A','均',6), req('數B','均',6), req('社','前',12), req('英聽','A',0)],
          ['在校學業','學測英文','學測國文','英語文學業','國語文學業','學測社會','歷史學業'],
          'R1:8人(17%) / R2:7人(3%)'),
        star(113, '00102', 16,
          [req('國','前',12), req('英','頂',13), req('數A','均',6), req('數B','均',6), req('社','前',12), req('英聽','A',0)],
          ['在校學業','學測英文','學測國文','英語文學業','國語文學業','學測社會','歷史學業'],
          'R1:14人(12%) / R2:2人(1%)'),
      ]),
      dept('00103', '歷史學系', '歷史學系', '一', [
        star(114, '00103', 6,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測社會','學測國文','歷史學業','國語文學業'],
          'R1:2人(7%) / R2:4人(3%,社40)'),
        star(113, '00103', 6,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測社會','學測國文','歷史學業','國語文學業'],
          'R1:4人(8%) / R2:2人(3%,國英社43,英14,社15,國14,歷史1%,國語文2%)'),
      ]),
      dept('00104', '哲學系', '哲學系', '一', [
        star(114, '00104', 4,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('數B','前',10), req('社','均',10)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','數學學業'],
          'R1:2人(2%) / R2:2人(7%)'),
        star(113, '00104', 5,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('數B','前',9), req('社','均',10)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','數學學業'],
          'R1:1人(4%) / R2:4人(5%,國英社42)'),
      ]),
      dept('00105', '人類學系', '人類學系', '一', [
        star(114, '00105', 8,
          [req('國','前',12), req('英','前',11), req('社','均',6), req('自','後',12), req('英聽','B',0)],
          ['在校學業','學測英文','學測社會','學測國英數B社','英語文學業','學測國文','歷史學業'],
          'R1:3人(14%) / R2:5人(6%)'),
        star(113, '00105', 6,
          [req('國','前',12), req('英','前',11), req('社','均',6), req('自','後',12), req('英聽','B',0)],
          ['在校學業','學測英文','學測社會','學測國英數B社','英語文學業','學測國文','歷史學業'],
          'R1:3人(6%) / R2:3人(2%)'),
      ]),
      dept('00106', '圖書資訊學系', '圖書資訊學系', '一', [
        star(114, '00106', 7,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','均',10)],
          ['在校學業','國語文學業','英語文學業','學測國英社','學測國文','學測英文','數學學業'],
          'R1:7人(2%,國語文4%) / R2:-'),
        star(113, '00106', 7,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('數B','均',6), req('社','均',10)],
          ['在校學業','國語文學業','英語文學業','學測國英社','學測國文','學測英文','數學學業'],
          'R1:7人(6%) / R2:-'),
      ]),
      dept('00107', '日本語文學系', '日本語文學系', '一', [
        star(114, '00107', 7,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測英文','學測國文','學測社會','學測國英社','英語文學業','國語文學業'],
          'R1:2人(7%) / R2:5人(4%,社14)'),
        star(113, '00107', 7,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測英文','學測國文','學測社會','學測國英數B社','學測數B','英語文學業'],
          'R1:7人(4%) / R2:-'),
      ]),
      dept('00108', '戲劇學系', '戲劇學系', '一', [
        star(114, '00108', 4,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','均',10)],
          ['在校學業','學測英文','學測國文','學測國英數B社','學測數B','英語文學業','國語文學業'],
          'R1:0人 / R2:4人(6%)'),
        star(113, '00108', 4,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','均',10)],
          ['在校學業','學測英文','學測國文','學測國英數B社','學測數B','英語文學業','國語文學業'],
          'R1:2人(8%) / R2:2人(6%)'),
      ]),
      dept('00109', '地理環境資源學系', '地理環境資源學系', '一', [
        star(114, '00109', 4,
          [req('英','前',11), req('數A','頂',11), req('社','前',12)],
          ['在校學業','學測英數A社','學測英文','學測數A','學測社會','地理學業','英語文學業'],
          'R1:1人(9%) / R2:1人(4%)'),
        star(113, '00109', 4,
          [req('英','前',11), req('數A','頂',12), req('社','前',12)],
          ['在校學業','學測英數A社','學測英文','學測數A','學測社會','地理學業','英語文學業'],
          'R1:0人 / R2:2人(10%)'),
      ]),
      dept('00110', '政治學系政治理論組', '政治學系', '一', [
        star(114, '00110', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:8人(6%) / R2:-'),
        star(113, '00110', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:7人(10%) / R2:1人(2%,國英社44)'),
      ]),
      dept('00111', '政治學系國際關係組', '政治學系', '一', [
        star(114, '00111', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:8人(1%,國英社38) / R2:-'),
        star(113, '00111', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:8人(1%,國英社39) / R2:-'),
      ]),
      dept('00112', '政治學系公共行政組', '政治學系', '一', [
        star(114, '00112', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:8人(2%) / R2:-'),
        star(113, '00112', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('數B','均',6), req('社','前',12)],
          ['在校學業','學測國英社','學測英文','學測國文','學測社會','英語文學業','國語文學業'],
          'R1:8人(3%) / R2:-'),
      ]),
      dept('00113', '經濟學系A組', '經濟學系', '一', [
        star(114, '00113', 11,
          [req('英','前',11), req('數A','頂',11), req('社','前',12)],
          ['在校學業','學測英數A社','學測數A','數學學業','學測英文','英語文學業','學測社會'],
          'R1:5人(11%) / R2:6人(2%,英數A社38,數A12,數學3%)'),
        star(113, '00113', 11,
          [req('英','前',11), req('數A','頂',12), req('社','前',12)],
          ['在校學業','學測英數A社','學測數A','數學學業','學測英文','英語文學業','學測社會'],
          'R1:1人(1%) / R2:10人(10%,英數A社39)'),
      ]),
      dept('00114', '社會學系', '社會學系', '一', [
        star(114, '00114', 6,
          [req('國','前',12), req('英','前',11), req('數B','前',10), req('社','前',12)],
          ['在校學業','學測國英社','學測數B','學測英文','英語文學業','數學學業','公社學業'],
          'R1:2人(6%) / R2:4人(15%)'),
        star(113, '00114', 6,
          [req('國','前',12), req('英','前',11), req('數B','前',9), req('社','前',12)],
          ['在校學業','學測國英社','學測數B','學測英文','英語文學業','數學學業','公社學業'],
          'R1:3人(19%) / R2:3人(2%)'),
      ]),
      dept('00115', '社會工作學系', '社會工作學系', '一', [
        star(114, '00115', 4,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','均',10)],
          ['在校學業','學測英文','學測國文','學測社會','學測數B','英語文學業','國語文學業'],
          'R1:1人(2%) / R2:3人(11%,英13)'),
        star(113, '00115', 4,
          [req('國','前',12), req('英','前',11), req('數B','均',6), req('社','均',10)],
          ['在校學業','學測英文','學測國文','學測社會','學測數B','英語文學業','國語文學業'],
          'R1:4人(7%) / R2:-'),
      ]),
      dept('00117', '工商管理學系企業管理組', '工商管理學系', '一', [
        star(114, '00117', 7,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',11), req('社','前',12)],
          ['在校學業','學測國英數A社','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:0人 / R2:7人(7%,國英數A社52)'),
        star(113, '00117', 7,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',12), req('社','前',12)],
          ['在校學業','學測國英數A社','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:0人 / R2:5人(15%)'),
      ]),
      dept('00118', '會計學系', '會計學系', '一', [
        star(114, '00118', 10,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',11), req('社','前',12)],
          ['在校學業','學測國英數A社','學測英文','英語文學業','學測數A','數學學業','學測國文'],
          'R1:3人(2%) / R2:7人(3%)'),
        star(113, '00118', 10,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',12), req('社','前',12)],
          ['在校學業','學測國英數A社','學測英文','英語文學業','學測數A','數學學業','學測國文'],
          'R1:0人 / R2:6人(16%)'),
      ]),
      dept('00119', '財務金融學系', '財務金融學系', '一', [
        star(114, '00119', 16,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',11)],
          ['在校學業','學測國英數A','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:11人(6%) / R2:5人(1%,國英數A41)'),
        star(113, '00119', 12,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',12)],
          ['在校學業','學測國英數A','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:8人(4%) / R2:4人(2%,國英數A 45)'),
      ]),
      dept('00120', '國際企業學系', '國際企業學系', '一', [
        star(114, '00120', 7,
          [req('國','頂',13), req('英','頂',13), req('數A','前',9), req('社','前',12)],
          ['在校學業','學測國英數A社','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:7人(1%,國英數A社53) / R2:-'),
        star(113, '00120', 5,
          [req('國','頂',13), req('英','頂',13), req('數A','前',10), req('社','前',12)],
          ['在校學業','學測國英數A社','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:5人(1%,國英數A社51) / R2:-'),
      ]),
      dept('00121', '法律學系法學組', '法律學系', '一', [
        star(114, '00121', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',10), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:9人(5%) / R2:-'),
        star(113, '00121', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',9), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:4人(10%) / R2:5人(3%,國英數B社59)'),
      ]),
      dept('00122', '法律學系司法組', '法律學系', '一', [
        star(114, '00122', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',10), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:9人(8%) / R2:-'),
        star(113, '00122', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',9), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:8人(1%) / R2:1人(1%)'),
      ]),
      dept('00123', '法律學系財經法學組', '法律學系', '一', [
        star(114, '00123', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',10), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:9人(1%,國英數B社54) / R2:-'),
        star(113, '00123', 9,
          [req('國','頂',13), req('英','頂',13), req('數B','前',9), req('社','頂',13)],
          ['在校學業','學測國英數B社','英語文學業','國語文學業','數學學業','學測數B','學測社會'],
          'R1:9人(1%,國英數B社56,英語文1%,國語文1%,數學1%) / R2:-'),
      ]),

      // ==================== 第二類 ====================
      dept('00124', '數學系', '數學系', '二', [
        star(114, '00124', 5,
          [req('英','前',11), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','數學學業','物理學業','學測英文','學測英數A自'],
          'R1:0人 / R2:3人(9%)'),
        star(113, '00124', 5,
          [req('英','頂',13), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','數學學業','物理學業','學測英文','學測英數A自'],
          'R1:1人(3%) / R2:4人(3%)'),
      ]),
      dept('00125', '物理學系', '物理學系', '二', [
        star(114, '00125', 4,
          [req('英','頂',13), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測自然','物理學業','學測數A','數學學業','學測英文','英語文學業'],
          'R1:4人(1%,自15,物理1%) / R2:-'),
        star(113, '00125', 4,
          [req('英','頂',13), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測自然','物理學業','學測數A','數學學業','學測英文','英語文學業'],
          'R1:4人(1%,自15) / R2:-'),
      ]),
      dept('00126', '化學系', '化學系', '二', [
        star(114, '00126', 5,
          [req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測英文','學測國文','學測國英數A自','化學學業'],
          'R1:3人(1%) / R2:2人(3%)'),
        star(113, '00126', 5,
          [req('英','頂',12), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測英文','學測國文','學測國英數A自','化學學業'],
          'R1:1人(4%) / R2:4人(2%)'),
      ]),
      dept('00127', '地質科學系', '地質科學系', '二', [
        star(114, '00127', 2,
          [req('英','均',8), req('數A','均',6), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測英文','地科學業','物理學業','化學學業'],
          'R1:1人(4%) / R2:1人(4%,自14)'),
        star(113, '00127', 2,
          [req('英','均',8), req('數A','均',7), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測英文','地科學業','物理學業','化學學業'],
          'R1:2人(10%) / R2:-'),
      ]),
      dept('00128', '大氣科學系', '大氣科學系', '二', [
        star(114, '00128', 3,
          [req('英','前',11), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','地科學業','物理學業'],
          'R1:0人 / R2:1人(1%)'),
        star(113, '00128', 3,
          [req('英','前',12), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','地科學業','物理學業'],
          'R1:3人(5%) / R2:-'),
      ]),
      dept('00129', '經濟學系B組', '經濟學系', '二', [
        star(114, '00129', 5,
          [req('英','前',11), req('數A','頂',11), req('自','前',12)],
          ['在校學業','學測英數A自','學測數A','數學學業','學測英文','英語文學業','學測自然'],
          'R1:1人(1%) / R2:4人(8%,英數A自37)'),
        star(113, '00129', 5,
          [req('英','前',11), req('數A','頂',12), req('自','前',12)],
          ['在校學業','學測英數A自','學測數A','數學學業','學測英文','英語文學業','學測自然'],
          'R1:3人(6%) / R2:2人(6%)'),
      ]),
      dept('00130', '土木工程學系', '土木工程學系', '二', [
        star(114, '00130', 12,
          [req('英','前',11), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測數A','學測英文','學測自然','學測國文','學測國英數A自','物理學業'],
          'R1:1人(1%) / R2:8人(15%)'),
        star(113, '00130', 10,
          [req('英','前',11), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測數A','學測英文','學測自然','學測國文','學測國英數A自','物理學業'],
          'R1:1人(3%) / R2:9人(10%)'),
      ]),
      dept('00131', '機械工程學系', '機械工程學系', '二', [
        star(114, '00131', 16,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','物理學業','數學學業','化學學業'],
          'R1:13人(4%) / R2:3人(2%,數A13)'),
        star(113, '00131', 16,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','物理學業','數學學業','化學學業'],
          'R1:16人(3%,數A 13) / R2:-'),
      ]),
      dept('00132', '化學工程學系', '化學工程學系', '二', [
        star(114, '00132', 16,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','數學學業','物理學業','化學學業'],
          'R1:12人(6%) / R2:4人(4%,數A13)'),
        star(113, '00132', 10,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','數學學業','物理學業','化學學業'],
          'R1:10人(1%,數A 11,自13) / R2:-'),
      ]),
      dept('00133', '工程科學及海洋工程學系', '工程科學及海洋工程學系', '二', [
        star(114, '00133', 5,
          [req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','數學學業','物理學業','學測英文','學測國文'],
          'R1:1人(2%) / R2:4人(12%)'),
        star(113, '00133', 5,
          [req('英','頂',12), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','數學學業','物理學業','學測英文','學測國文'],
          'R1:0人 / R2:5人(3%)'),
      ]),
      dept('00134', '材料科學與工程學系', '材料科學與工程學系', '二', [
        star(114, '00134', 4,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','物理學業','數學學業','化學學業'],
          'R1:4人(1%,數A14,自14) / R2:-'),
        star(113, '00134', 4,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','物理學業','數學學業','化學學業'],
          'R1:4人(1%,數A 14,自14,英文15) / R2:-'),
      ]),
      dept('00135', '醫學工程學系', '醫學工程學系', '二', [
        star(114, '00135', 2,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','物理學業','化學學業'],
          'R1:2人(1%) / R2:-'),
        star(113, '00135', 4,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','學測國英數A自','數學學業'],
          'R1:4人(1%,數A 11,自14) / R2:-'),
      ]),
      dept('00136', '生物環境系統工程學系', '生物環境系統工程學系', '二', [
        star(114, '00136', 4,
          [req('英','前',11), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','學測國英數A自','數學學業'],
          'R1:0人 / R2:-'),
        star(113, '00136', 4,
          [req('英','前',11), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','學測國英數A自','數學學業'],
          'R1:0人 / R2:4人(13%)'),
      ]),
      dept('00137', '生物機電工程學系', '生物機電工程學系', '二', [
        star(114, '00137', 4,
          [req('英','前',11), req('數A','前',9), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測英文','學測國文','物理學業'],
          'R1:3人(3%) / R2:1人(2%,國英數A自54)'),
        star(113, '00137', 4,
          [req('英','前',11), req('數A','前',10), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測英文','學測國文','物理學業'],
          'R1:4人(4%,國英數A自53) / R2:-'),
      ]),
      dept('00138', '工商管理學系科技管理組', '工商管理學系', '二', [
        star(114, '00138', 5,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',11), req('自','前',12)],
          ['在校學業','學測國英數A自','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:1人(1%) / R2:2人(10%)'),
        star(113, '00138', 5,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',12), req('自','前',12)],
          ['在校學業','學測國英數A自','學測數A','學測英文','學測國文','數學學業','英語文學業'],
          'R1:0人 / R2:3人(8%)'),
      ]),
      dept('00139', '資訊管理學系', '資訊管理學系', '二', [
        star(114, '00139', 3,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測英文','學測國文','學測自然','數學學業'],
          'R1:3人(1%,國英數A自55) / R2:-'),
        star(113, '00139', 3,
          [req('國','頂',13), req('英','頂',13), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測英文','學測國文','學測自然','數學學業'],
          'R1:3人(2%,國英數A自56) / R2:-'),
      ]),
      dept('00140', '電機工程學系', '電機工程學系', '二', [
        star(114, '00140', 18,
          [req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測英文','學測國文','數學學業'],
          'R1:18人(1%,國英數A自59,數A15) / R2:-'),
        star(113, '00140', 18,
          [req('英','頂',13), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測英文','學測國文','數學學業'],
          'R1:18人(1%,國英數A自59,數A 15) / R2:-'),
      ]),
      dept('00141', '資訊工程學系', '資訊工程學系', '二', [
        star(114, '00141', 10,
          [req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','數學學業','物理學業'],
          'R1:10人(1%,數A14,自15) / R2:-'),
        star(113, '00141', 11,
          [req('英','頂',12), req('數A','頂',13), req('自','頂',13)],
          ['在校學業','學測數A','學測自然','學測英文','學測國文','數學學業','物理學業'],
          'R1:11人(1%,數A 15,自14,英文14) / R2:-'),
      ]),
      dept('00143', '經濟學系C組', '經濟學系', '二', [
        star(114, '00143', 10,
          [req('英','前',11), req('數A','頂',11), req('自','前',12)],
          ['在校學業','學測英數A自','學測數A','數學學業','學測英文','英語文學業','學測自然'],
          'R1:1人(1%) / R2:9人(4%)'),
        star(113, '00143', 10,
          [req('英','前',11), req('數A','頂',12), req('自','前',12)],
          ['在校學業','學測英數A自','學測數A','數學學業','學測英文','英語文學業','學測自然'],
          'R1:1人(4%) / R2:9人(8%)'),
      ]),

      // ==================== 第三類 ====================
      dept('00116', '生物產業傳播暨發展學系', '生物產業傳播暨發展學系', '三', [
        star(114, '00116', 5,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('社','前',12)],
          ['在校學業','學測英文','學測國文','學測數A','英語文學業','國語文學業','數學學業'],
          'R1:3人(1%) / R2:2人(2%,英15)'),
        star(113, '00116', 5,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('社','前',12)],
          ['在校學業','學測英文','學測國文','學測數A','英語文學業','國語文學業','數學學業'],
          'R1:4人(12%) / R2:1人(2%,英15)'),
      ]),
      dept('00142', '心理學系', '心理學系', '三', [
        star(114, '00142', 10,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測數A','學測英文','學測國文','學測自然','生物學業','化學學業'],
          'R1:10人(8%) / R2:-'),
        star(113, '00142', 10,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測數A','學測英文','學測國文','學測自然','生物學業','化學學業'],
          'R1:3人(3%) / R2:7人(4%,數A 12)'),
      ]),
      dept('00144', '藥學系', '藥學系', '三', [
        star(114, '00144', 9,
          [req('國','均',10), req('英','均',8), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測國英數A自','學測英文','學測國文','化學學業'],
          'R1:9人(3%) / R2:-'),
        star(113, '00144', 9,
          [req('國','均',11), req('英','均',8), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測自然','學測數A','學測國英數A自','學測英文','學測國文','化學學業'],
          'R1:9人(1%,自13,數A 13,國英數A自53) / R2:-'),
      ]),
      dept('00145', '醫學檢驗暨生物技術學系', '醫學檢驗暨生物技術學系', '三', [
        star(114, '00145', 6,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','化學學業','生物學業'],
          'R1:2人(1%) / R2:4人(1%)'),
        star(113, '00145', 6,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','化學學業','生物學業'],
          'R1:1人(2%) / R2:5人(5%)'),
      ]),
      dept('00146', '護理學系', '護理學系', '三', [
        star(114, '00146', 6,
          [req('英','均',8), req('數A','均',6), req('自','均',9)],
          ['在校學業','學測英文','學測數A','學測自然','英語文學業','數學學業','生物學業'],
          'R1:5人(13%) / R2:1人(5%)'),
        star(113, '00146', 6,
          [req('英','均',8), req('數A','均',7), req('自','均',9)],
          ['在校學業','學測英文','學測數A','學測自然','英語文學業','數學學業','生物學業'],
          'R1:6人(3%,英11) / R2:-'),
      ]),
      dept('00147', '物理治療學系', '物理治療學系', '三', [
        star(114, '00147', 7,
          [req('英','頂',13), req('數A','前',9), req('自','頂',13)],
          ['在校學業','學測英文','學測數A','學測自然','國語文學業','數學學業','生物學業'],
          'R1:1人(1%) / R2:6人(3%,自15)'),
        star(113, '00147', 7,
          [req('英','頂',13), req('數A','前',10), req('自','頂',13)],
          ['在校學業','學測英文','學測數A','學測自然','國語文學業','數學學業','生物學業'],
          'R1:2人(1%) / R2:5人(4%,英文15)'),
      ]),
      dept('00148', '職能治療學系', '職能治療學系', '三', [
        star(114, '00148', 2,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測英文','學測國文','學測自然','學測數A','英語文學業','數學學業'],
          'R1:2人(6%) / R2:-'),
        star(113, '00148', 2,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測英文','學測國文','學測自然','學測數A','英語文學業','數學學業'],
          'R1:0人 / R2:2人(4%)'),
      ]),
      dept('00149', '農藝學系', '農藝學系', '三', [
        star(114, '00149', 5,
          [req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','生物學業','化學學業'],
          'R1:0人 / R2:5人(13%)'),
        star(113, '00149', 5,
          [req('英','前',11), req('數A','前',10), req('自','前',13)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','生物學業','化學學業'],
          'R1:1人(2%) / R2:2人(9%)'),
      ]),
      dept('00150', '農業化學系', '農業化學系', '三', [
        star(114, '00150', 4,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','化學學業','生物學業'],
          'R1:0人 / R2:4人(7%)'),
        star(113, '00150', 4,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','化學學業','生物學業'],
          'R1:1人(1%) / R2:3人(4%)'),
      ]),
      dept('00151', '森林環境暨資源學系', '森林環境暨資源學系', '三', [
        star(114, '00151', 7,
          [req('英','均',8), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測英數A自','學測自然','學測英文','學測數A','生物學業','英語文學業'],
          'R1:2人(6%) / R2:5人(9%,英數A自35)'),
        star(113, '00151', 7,
          [req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測英數A自','學測自然','學測英文','學測數A','生物學業','英語文學業'],
          'R1:0人 / R2:3人(16%)'),
      ]),
      dept('00152', '動物科學技術學系', '動物科學技術學系', '三', [
        star(114, '00152', 8,
          [req('國','前',12), req('英','前',11), req('數A','均',6), req('自','前',12)],
          ['在校學業','學測自然','學測英文','學測國文','學測數A','生物學業','英語文學業'],
          'R1:3人(18%) / R2:5人(3%)'),
        star(113, '00152', 7,
          [req('國','前',12), req('英','前',11), req('數A','均',7), req('自','前',13)],
          ['在校學業','學測自然','學測英文','學測國文','學測數A','生物學業','英語文學業'],
          'R1:0人 / R2:5人(18%)'),
      ]),
      dept('00153', '農業經濟學系', '農業經濟學系', '三', [
        star(114, '00153', 8,
          [req('國','均',10), req('英','均',8), req('數A','均',6)],
          ['在校學業','數學學業','英語文學業','國語文學業','學測國英數A','學測數A','學測英文'],
          'R1:8人(3%) / R2:-'),
        star(113, '00153', 8,
          [req('國','均',11), req('英','均',8), req('數A','均',7)],
          ['在校學業','數學學業','英語文學業','國語文學業','學測國英數A','學測數A','學測英文'],
          'R1:8人(4%) / R2:-'),
      ]),
      dept('00154', '園藝暨景觀學系', '園藝暨景觀學系', '三', [
        star(114, '00154', 7,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測國文','學測英文','英語文學業'],
          'R1:0人 / R2:5人(15%)'),
        star(113, '00154', 7,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測國英數A自','學測數A','學測自然','學測國文','學測英文','英語文學業'],
          'R1:0人 / R2:4人(7%)'),
      ]),
      dept('00155', '獸醫學系', '獸醫學系', '三', [
        star(114, '00155', 6,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測國文','化學學業','學測數A','學測英文','學測國英數A自','物理學業'],
          'R1:6人(2%) / R2:-'),
        star(113, '00155', 6,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測國文','化學學業','學測數A','學測英文','學測國英數A自','物理學業'],
          'R1:6人(2%) / R2:-'),
      ]),
      dept('00156', '昆蟲學系', '昆蟲學系', '三', [
        star(114, '00156', 3,
          [req('國','前',12), req('英','前',11), req('數A','前',9), req('自','前',12)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','生物學業','化學學業'],
          'R1:0人 / R2:3人(9%)'),
        star(113, '00156', 3,
          [req('國','前',12), req('英','前',11), req('數A','前',10), req('自','前',12)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','生物學業','化學學業'],
          'R1:0人 / R2:2人(16%)'),
      ]),
      dept('00157', '植物病理與微生物學系', '植物病理與微生物學系', '三', [
        star(114, '00157', 2,
          [req('英','頂',13), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','學測國文','生物學業'],
          'R1:0人 / R2:-'),
        star(113, '00157', 4,
          [req('英','頂',13), req('數A','頂',12), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','學測國文','生物學業'],
          'R1:0人 / R2:-'),
      ]),
      dept('00158', '公共衛生學系', '公共衛生學系', '三', [
        star(114, '00158', 6,
          [req('英','前',11), req('數A','均',9), req('自','前',12)],
          ['在校學業','學測英數A社自','學測數A','學測英文','學測自然','學測社會','英語文學業'],
          'R1:1人(1%) / R2:5人(6%)'),
        star(113, '00158', 6,
          [req('英','前',11), req('數A','均',10), req('自','前',12)],
          ['在校學業','學測英數A社自','學測數A','學測英文','學測自然','學測社會','英語文學業'],
          'R1:2人(16%) / R2:4人(4%,英數A社自48,數A 11)'),
      ]),
      dept('00159', '生命科學系', '生命科學系', '三', [
        star(114, '00159', 6,
          [req('英','頂',13), req('數A','前',9), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','學測國文','生物學業'],
          'R1:1人(3%) / R2:5人(4%)'),
        star(113, '00159', 6,
          [req('英','頂',12), req('數A','前',10), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測英文','學測數A','學測國文','生物學業'],
          'R1:3人(1%) / R2:3人(4%)'),
      ]),
      dept('00160', '生化科技學系', '生化科技學系', '三', [
        star(114, '00160', 3,
          [req('英','前',11), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','學測國文','生物學業'],
          'R1:1人(2%) / R2:2人(2%)'),
        star(113, '00160', 3,
          [req('英','前',12), req('數A','頂',11), req('自','頂',13)],
          ['在校學業','學測國英數A自','學測自然','學測數A','學測英文','學測國文','生物學業'],
          'R1:2人(9%) / R2:1人(1%)'),
      ]),
    ],
  },
];

export function getAllCities(): string[] {
  return [...new Set(universities.map((u) => u.location.city))];
}
